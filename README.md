# ğŸ§­ Flutter æ¨¡å—åŒ–æ¶æ„ï¼šMVVM + BLoC + è·¯ç”±è§£è€¦

æœ¬é¡¹ç›®é‡‡ç”¨é«˜åº¦æ¨¡å—åŒ–çš„æ–¹å¼è¿›è¡Œä¸šåŠ¡åˆ’åˆ†ï¼Œç»“åˆ MVVM æ¨¡å¼å’Œ BLoC çŠ¶æ€ç®¡ç†æ–¹æ¡ˆï¼Œå®ç°é€»è¾‘ä¸ç•Œé¢è§£è€¦ï¼Œå…·å¤‡è‰¯å¥½çš„æ‰©å±•æ€§ä¸å›¢é˜Ÿåä½œæ•ˆç‡ã€‚é€‚ç”¨äºä¸­å¤§å‹ Flutter é¡¹ç›®ï¼Œå¼€ç®±å³ç”¨ã€‚

---

## ğŸ“¦ é¡¹ç›®ç»“æ„æ€»è§ˆ

``` 
lib/
â”œâ”€â”€ core/                  # åŸºç¡€è®¾æ–½å±‚ï¼ˆæŠ€æœ¯æ ˆç›¸å…³å°è£…ï¼‰
â”‚   â”œâ”€â”€ exceptions/        # å…¨å±€å¼‚å¸¸å®šä¹‰ä¸å¤„ç†
â”‚   â”œâ”€â”€ network/           # ç½‘ç»œè¯·æ±‚å°è£…
â”‚   â”œâ”€â”€ utils/             # å·¥å…·æ–¹æ³•/æ‰©å±•å‡½æ•°
â”‚   â””â”€â”€ router/            # è·¯ç”±æ³¨å†Œä¸ç»Ÿä¸€è·³è½¬å…¥å£

â”œâ”€â”€ common/                # é€šç”¨æ¨¡å—ï¼ˆè·¨ä¸šåŠ¡å¤ç”¨ï¼‰
â”‚   â”œâ”€â”€ models/            # é€šç”¨æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ widgets/           # é€šç”¨ UI ç»„ä»¶
â”‚   â””â”€â”€ services/          # è·¨æ¨¡å—æœåŠ¡ç±»ï¼ˆå¦‚å…¨å±€ç”¨æˆ·ä¿¡æ¯ï¼‰

â””â”€â”€ module/                # å„ä¸šåŠ¡æ¨¡å—ï¼ˆæ¨ªå‘æ‹†åˆ†ï¼‰
    â””â”€â”€ moduleA/           
        â”œâ”€â”€ router/        # æ¨¡å—å†…é¡µé¢è·¯ç”±è·¯å¾„ä¸å¯¼å‡ºè·¯å¾„
        â”œâ”€â”€ model/         # æ•°æ®æ¨¡å‹ï¼ˆä¸šåŠ¡å®ä½“ï¼‰
        â”œâ”€â”€ viewmodel/     # Blocï¼ˆè§†å›¾æ¨¡å‹å±‚ï¼‰
        â””â”€â”€ view/          # UI å±‚ï¼ŒæŒ‰é¡µé¢å’Œç»„ä»¶æ‹†åˆ†
            â”œâ”€â”€ pages/
            â”œâ”€â”€ widgets/
            â””â”€â”€ dialogs/
```

---

## ğŸ”„ MVVM æ¨¡å¼è§£è¯»ï¼ˆåŸºäº BLoCï¼‰

æœ¬é¡¹ç›®é‡‡ç”¨ `BLoC` æ›¿ä»£ä¼ ç»Ÿ ViewModelï¼Œæ„å»ºå“åº”å¼ã€å¯æµ‹è¯•çš„ MVVM æ¶æ„ã€‚

### æ•°æ®æµè¯´æ˜

```
UI(View)  â†’  Eventï¼ˆç”¨æˆ·æ„å›¾ï¼‰
     â†“
 Blocï¼ˆè§†å›¾é€»è¾‘ä¸çŠ¶æ€å˜æ›´ï¼‰
     â†“
 Stateï¼ˆçŠ¶æ€ï¼‰â†’ æ›´æ–° UI
```

### æ¯ä¸ª Bloc æ¨¡å—åŒ…å«ï¼š

- `Event`: ç”¨æˆ·æ“ä½œä¸å¤–éƒ¨è¾“å…¥çš„æŠ½è±¡
- `State`: UI çŠ¶æ€ï¼ˆå¦‚åŠ è½½ä¸­ã€æˆåŠŸã€å¤±è´¥ã€ç©ºæ•°æ®ï¼‰
- `Bloc`: è¿æ¥è¾“å…¥è¾“å‡ºã€å¤„ç†ä¸šåŠ¡é€»è¾‘
- `Repository`: å°è£…æ•°æ®è·å–é€»è¾‘ï¼ˆå¦‚ APIï¼‰

---

## ğŸš€ è·¯ç”±æ¨¡å—åŒ–è®¾è®¡

### è®¾è®¡ç›®æ ‡

- **é›†ä¸­ç®¡ç†è·¯ç”±è¡¨**
- **æ¨¡å—ç‹¬ç«‹æ³¨å†Œä¸æš´éœ²è·¯å¾„**
- **æ”¯æŒæ·±åº¦é“¾æ¥å’Œå‚æ•°è·³è½¬**
- **æ³¨å†Œé”™è¯¯å›é€€ NotFound é¡µé¢**

### æ–‡ä»¶ç»“æ„

```
core/router/
â”œâ”€â”€ app_router.dart         # æ€»è·¯ç”±æ§åˆ¶å™¨
â”œâ”€â”€ base_module_route.dart  # æ¨¡å—è·¯ç”±æ¥å£è§„èŒƒ
â””â”€â”€ not_found_page.dart     # æœªæ³¨å†Œé¡µé¢æç¤º
```

### æ¨¡å—æ³¨å†Œæ–¹å¼

æ¯ä¸ªæ¨¡å—å®ç° `BaseModuleRoute`ï¼š

```dart
class HomeModuleRoute implements BaseModuleRoute {
  @override
  String get moduleName => "home";

  @override
  String get entryPath => "/home";

  @override
  List<String> get exportedPages => ["/home", "/home/detail"];

  @override
  Map<String, WidgetBuilder> get routes => {
    "/home": (_) => HomePage(),
    "/home/detail": (_) => DetailPage(),
  };
}
```

åœ¨ `AppRouter` ä¸­ç»Ÿä¸€æ³¨å†Œï¼š

```dart
static final List<BaseModuleRoute> _modules = [
  HomeModuleRoute(),
  ProfileModuleRoute(),
];
```

è°ƒç”¨æ–¹å¼ç»Ÿä¸€ï¼š

```dart
AppRouter.push(context, "/profile", arguments: {"id": 123});
AppRouter.replaceFromUri(context, Uri.parse("/home/detail?id=1"));
```

